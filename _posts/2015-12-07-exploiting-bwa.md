---
layout: post
title: Exploiting Broken Web Apps (BWA)
---

Previously I wrote a quick post about installing OWASP's Broken Web App. This post will be about exploiting the BWA and by that I mean I'm posting a few comments on how to do some [reported vulnerabilities](http://sourceforge.net/p/owaspbwa/tickets/?source=navbar) from sourceforge's issues and [irongeek.com](http://www.irongeek.com/i.php?page=videos/web-application-pen-testing-tutorials-with-mutillidae). This post assumes you have the OWASP BWA virtual machine up and running and that your VM IP address is mapped to owaspbwa.com in /etc/hosts (in your testing machine, not the VM).

I'll do my best to give a complete list of information for each hack. Including where to go, what to do, why the exploit is a thing, and how to do it.

# List of exploiting vulnerabilities by type

## XSS
1 Reflected XSS
* goto: http://owaspbwa.com/peruggia/index.php
* action: Click on Learn in the navbar. Then click on one of the Papers listed on that page.
* description: This loads a new page.  In your URL look after the ? symbol, you will see parameters and their values. What happens if you modify the values right from the URL? What if you injected some nice javascript?
* exploit: Change a value to <script>alert(1)</script> so the url might look like http://owaspbwa.com/peruggia/index.php?action=learn&type=<script>alert(1)</script>&paper=...

2 Moar reflected XSS
* goto: owaspbwa.com/getboo/
* action: Search for anything, like "foobar"
* description: Variables stored in the url can be modified like above
* exploit: Replace your keyword with the XSS script from 1.

3 Stored XSS
* goto: owaspbwa.com/wackopacko
* action: Log in, view an image, and leave a comment
* description: If there is a lack of validation, you can write code and leave that in your comment
* exploit: Use a script while writing your comment. A fun one is `<script>x=prompt("Question");document.write(x);</script>`

## SQL Injection
1 Login Bypass
* goto: owaspbwa.com/peruggia
* action: Log in
* description: If users are stored in a database, a query is comparing the existing users to the parameters you give. This can be manipulated into whatever you need, even logic that overrides a password
* exploit: Leave the password blank and use  `' or 1=1-- -&password=aaa` as the username

2 Display useful information for more hacks
* goto: owaspbwa.com/peruggia
* action: View a picture
* description: URLs sometimes contain parameters that become SQL queries. These can be manipulated as well
* exploit: Replace the value of the pic id in the URL and make it `-1 union all select 1,2,3,@@version`

## Directory Browsing
1 View directory contents, not webpages
* goto: owaspbwa.com/peruggia
* action: Try to find common directories that are used in web apps like images/ css/ or config/
* description: Most web apps do not expect you to go directly to browsers using the URL. They aren't properly configured to stop a user from viewing all the contents in that folder
* exploit: Append to the end of the URL a directory you want to travel to. such as images/

## Broken Authentication
1 Add or remove accounts (without admin credentials)
* goto: owaspbwa.com/peruggia
* action: Log in to admin (admin/admin), view the account tab and add a new user foo. Re-log in as user (user/user)
* description: Without proper authorization, a regular user could act as an admin
* exploit: Append `index.php?action=account&deleteuser=$SOMEONETODELETE` to the end of the url

## View "your uploads" of other people
* goto: owaspbwa.com/wackopacko
* action: Log in to a user (bryce/bryce) and click the link "view your uploaded pics"
* description: The action describes the intended use of the functionality. However look in the url, the only thing making sure you are viewing your pictures is the id. What if you changed that id?
* exploit: Modify userid to a different value to see someone else's uploaded images

## Direct Object Reference
1 View any user like they were your friend.
* goto: owaspbwa.com/AppSensorDemo/home.jsp
* action: Log in and view some on your friends
* description: An account may only be friends with 20 or so other users. They don't have direct links to users who aren't friends, so that user can't see non-friends right? Wrong. Each user is _directly referenced_ by their ID
* exploit: Change the ID in the URL to any number you like, most likely you won't find a user because it's random, but if you wrote a script, it could iterate through all the IDs and find every user
